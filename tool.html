<!-- FILE: tool.html -->
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Tool ‚Ä¢ AI Tools Directory</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Tool details ‚Ä¢ AI Tools Directory" />
  <link rel="icon" href="favicon.ico" />
  <link rel="stylesheet" href="assets/styles.css" />
  <script>
    // Simple utility to get query string param
    function qp(name){ const u=new URL(location.href); return u.searchParams.get(name); }
    function esc(s){ return String(s||"").replace(/[&<>\"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',\"'\":'&#39;'}[c])); }
    function pricingBadge(p) {
      const color = p==="free"?"#22a559": p==="freemium"?"#ff8c00": "#6c6c6c";
      return `<span class="badge" style="background:${color}1a;border-color:${color}4d;color:${color}">${esc(p)}</span>`;
    }
    function iconRow(t) {
      const arr=[];
      if (t.evidence_cites) arr.push("‚úÖ");
      if (t.local_onprem)  arr.push("üîí");
      if (t.edu_discount)  arr.push("üè´");
      if (t.free_tier)     arr.push("üîÅ");
      if (t.beta)          arr.push("üß™");
      return arr.length? `<span class="icons" title="‚úÖ cites ‚Ä¢ üîí local/on-prem ‚Ä¢ üè´ EDU ‚Ä¢ üîÅ free tier ‚Ä¢ üß™ beta">${arr.join(" ")}</span>` : "";
    }
  </script>
</head>
<body>
  <header>
    <div class="wrap">
      <a href="index.html" class="link-btn">‚Üê Back to directory</a>
    </div>
  </header>

  <main>
    <div class="wrap" id="tool-wrap">
      <!-- Populated by script -->
    </div>
  </main>

  <footer>
    <div class="wrap">
      <hr class="sep" />
      <small class="disclaimer">
        <strong>Tools & Links Disclaimer.</strong> The tools and external links referenced are provided solely for informational purposes. Inclusion does not constitute endorsement or preference; no affiliate relationships. Features, pricing, availability, and policies may change; verify current details and comply with your institution‚Äôs policies on AI use, research integrity, data privacy, and security. External websites are not under our control; links may change. All trademarks belong to their owners. No warranty is expressed or implied.
      </small>
    </div>
  </footer>

  <script>
    (async function(){
      const slug = qp("slug") || qp("id");
      const wrap = document.getElementById("tool-wrap");
      if (!slug) {
        wrap.innerHTML = `<div class="empty">No tool specified. <a href="index.html">Go back</a>.</div>`;
        return;
      }
      let tools = [];
      try {
        const res = await fetch("data/tools.json",{cache:"no-store"});
        tools = await res.json();
      } catch (e) {
        wrap.innerHTML = `<div class="empty">Could not load <code>data/tools.json</code>. <a href="index.html">Back</a>.</div>`;
        return;
      }
      const tool = tools.find(t => t.slug === slug || t.id === slug);
      if (!tool) {
        wrap.innerHTML = `<div class="empty">Tool not found. <a href="index.html">Back</a>.</div>`;
        return;
      }

      const logo = tool.logo ? `<img class="logo" src="${esc(tool.logo)}" alt="${esc(tool.name)} logo" loading="lazy" />`
                             : `<div class="logo" aria-hidden="true">${esc((tool.name||"").split(/\s+/).slice(0,2).map(p=>p[0]).join("").toUpperCase()||"AI")}</div>`;

      const cats = (tool.categories||[]).map(c=>`<span class="badge">${esc(c)}</span>`).join(" ");
      const tags = (tool.tags||[]).map(c=>`<span class="tag">${esc(c)}</span>`).join(" ");
      const icons = iconRow(tool);

      // Related: same first category
      let related = tools.filter(t => t.slug !== tool.slug && (t.categories||[])[0] === (tool.categories||[])[0]).slice(0,6);
      const relHTML = related.map(t => `
        <article class="card">
          ${t.logo ? `<img class="logo" src="${esc(t.logo)}" alt="${esc(t.name)} logo" loading="lazy" />` : `<div class="logo">${esc((t.name||"").split(/\s+/).slice(0,2).map(p=>p[0]).join("").toUpperCase())}</div>`}
          <div style="flex:1">
            <div class="title">
              <h3 style="margin:0;font-size:1rem">${esc(t.name)}</h3>
              <span class="right">${pricingBadge(t.pricing)}</span>
            </div>
            <p style="margin:6px 0 8px; color:#333">${esc(t.tagline || (t.description||"").slice(0,120))}</p>
            <div class="badges">${(t.categories||[]).slice(0,2).map(c=>`<span class="badge">${esc(c)}</span>`).join(" ")}</div>
          </div>
          <div class="cta"><a href="tool.html?slug=${encodeURIComponent(t.slug)}">View</a></div>
        </article>
      `).join("");

      wrap.innerHTML = `
        <article class="tool-hero">
          ${logo}
          <div style="flex:1">
            <h1 style="margin:0 0 6px">${esc(tool.name)}</h1>
            <div class="title">
              ${icons}
              <span class="right">${pricingBadge(tool.pricing)}</span>
            </div>
            <p class="lead" style="margin:6px 0 10px">${esc(tool.tagline)}</p>
            <p style="margin:0 0 10px">${esc(tool.description)}</p>
            <div class="badges">${cats}</div>
            <div class="tags" style="margin-top:10px">${tags}</div>
            <p style="margin-top:12px">
              <a class="cta" style="padding:10px 12px; border-radius:8px; background:#0b57d0; color:#fff; text-decoration:none; font-weight:700" href="${esc(tool.url)}" target="_blank" rel="noopener">Visit website ‚Üó</a>
            </p>
          </div>
        </article>
        <hr class="sep" />
        <section>
          <h2 style="font-size:1.1rem">Related tools</h2>
          <div class="related">${relHTML || '<div class="empty">No related tools found.</div>'}</div>
        </section>
      `;

      // JSON-LD for SoftwareApplication
      const ld = {
        "@context":"https://schema.org",
        "@type":"SoftwareApplication",
        "name": tool.name,
        "description": tool.description || tool.tagline || "",
        "applicationCategory": (tool.categories||[])[0] || "AIApplication",
        "operatingSystem": "Web",
        "offers": {"@type":"Offer","price": tool.pricing=="free"?"0":"0","priceCurrency":"USD"},
        "url": tool.url
      };
      const s = document.createElement("script");
      s.type="application/ld+json";
      s.textContent = JSON.stringify(ld);
      document.head.appendChild(s);
    })();
  </script>
</body>
</html>
